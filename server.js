!function(e){var t={};function r(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r.w={},r(r.s=25)}([function(e,t,r){"use strict";r.d(t,"a",function(){return o}),r.d(t,"b",function(){return a}),r.d(t,"f",function(){return i}),r.d(t,"g",function(){return c}),r.d(t,"c",function(){return u}),r.d(t,"d",function(){return l}),r.d(t,"e",function(){return p});var n=r(6),s=r.n(n),o="production",a="development"===o,i="localhost",c=process.env.PORT||4e3,u=a?"http://".concat(i,":").concat(c,"/"):"/",l=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return s.a.resolve.apply(s.a,[process.cwd()].concat(t))},p=require},function(e,t){e.exports=require("webpack")},function(e,t){e.exports=require("ssr-webpack-plugin")},function(e,t){e.exports=require("webpack-merge")},function(e,t){e.exports=require("debug")},function(e,t){e.exports=require("extract-text-webpack-plugin")},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("koa-static-cache")},function(e,t){e.exports=require("webpack-node-externals")},function(e,t){e.exports=require("friendly-errors-webpack-plugin")},function(e,t){e.exports=require("sw-precache-webpack-plugin")},function(e,t){e.exports=require("memory-fs")},function(e,t){e.exports=require("koa-webpack")},function(e,t){e.exports=require("react-server-renderer")},function(e,t){e.exports=require("lru-cache")},function(e,t){e.exports=require("koa-mount")},function(e,t){e.exports=require("koa-logger")},function(e,t){e.exports=require("koa-convert")},function(e,t){e.exports=require("koa-compress")},function(e,t){e.exports=require("koa-compose")},function(e,t){e.exports=require("koa-cash")},function(e,t){e.exports=require("koa")},function(e,t){e.exports=require("fs")},function(e,t,r){"use strict";r.r(t);var n=r(4),s=r.n(n),o=r(12),a=r.n(o),i=r(11),c=r.n(i),u=r(1),l=r.n(u),p=r(0),f=r(3),d=r.n(f),b=r(2),m=r(10),g=r.n(m),h=r(5),v=r.n(h),w=r(9),j=r.n(w);function x(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var y=p.b,O=!y,k=function(e){return v.a.extract({fallback:{loader:"react-style-loader",options:{manualInject:e}},use:[{loader:"css-loader",options:{minimize:O,souceMap:y}},{loader:"postcss-loader",options:{souceMap:y}},{loader:"sass-loader",options:{souceMap:y}}]})},P=function(e){return{test:/\.js$/,loader:"babel-loader",exclude:/node_modules/,options:function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){x(e,t,r[t])})}return e}({cacheDirectory:!0},e&&{presets:[["@babel/env",{modules:!1,exclude:["babel-plugin-transform-async-to-generator","babel-plugin-transform-regenerator"]}]]})}},q={mode:p.a,devtool:p.b&&"cheap-module-source-map",resolve:{alias:{lodash:"lodash-es"},extensions:[".js",".scss"],modules:[Object(p.d)("src"),"node_modules"]},module:{rules:[{test:/\.pug$/,use:["apply-loader",{loader:"pug-loader",options:{pretty:p.b}}]},{test:/\.scss$/,oneOf:[{test:/app.scss/,use:k()},{test:/./,use:k(!0)}]}]},plugins:[new l.a.DefinePlugin({__DEV__:p.b}),new v.a({disable:p.b,allChunks:!0,filename:"[name].[contenthash].css"}),new j.a]},S=d.a.smart(q,{entry:{app:[Object(p.d)("src/entry-client.js")]},resolve:{alias:{"create-api":"./create-api-client.js"}},output:{publicPath:p.c,path:Object(p.d)("dist/static"),filename:"[name].[".concat(p.b?"hash":"chunkhash","].js")},module:{rules:[P()]},optimization:{runtimeChunk:{name:"manifest"},splitChunks:{chunks:"initial",name:"vendors",cacheGroups:{test:function(e){var t=e.context,r=e.request;return/node_modules/.test(t)&&!/\.css$/.test(r)}}}},plugins:[new l.a.DefinePlugin({"process.env.REACT_ENV":'"client"',__SERVER__:!1}),new b.SSRClientPlugin({filename:"../ssr-client-manifest.json"})]});p.b||S.plugins.push(new g.a({cacheId:"react-hn",filename:"service-worker.js",minify:!0,dontCacheBustUrlsMatching:/./,staticFileGlobsIgnorePatterns:[/\.map$/,/\.json$/],runtimeCaching:[{urlPattern:"/",handler:"networkFirst"},{urlPattern:/\/(top|new|show|ask|jobs)/,handler:"networkFirst"},{urlPattern:"/item/:id",handler:"networkFirst"},{urlPattern:"/user/:id",handler:"networkFirst"}]}));var _=S,E=r(8),M=r.n(E),R=d.a.smart(q,{entry:Object(p.d)("src/entry-server.js"),resolve:{alias:{"create-api":"./create-api-server.js"}},target:"node",output:{path:Object(p.d)("dist"),filename:"[name].[chunkhash].js",libraryTarget:"commonjs2"},externals:M()({whitelist:/\.s?css$/}),module:{rules:[P(!0)]},plugins:[new l.a.DefinePlugin({"process.env.REACT_ENV":'"server"',__SERVER__:!0}),new b.SSRServerPlugin]}),F=s()("1stg:server:dev");t.default=function(e){var t,r,n,s,o=new Promise(function(e){t=e}),i=function(){t(),e.apply(void 0,arguments)},u=l()(_),f=a()({compiler:u,dev:{stats:{colors:!0}}});u.plugin("done",function(e){(e=e.toJson()).errors.forEach(F),e.warnings.forEach(F),e.errors.length||(s=f.dev.fileSystem,r=JSON.parse(s.readFileSync(Object(p.d)("dist/ssr-client-manifest.json"))),n&&i({bundle:n,clientManifest:r,fs:s}))});var d=new c.a,b=l()(R);return b.outputFileSystem=d,b.watch({},function(e,t){if(e)throw e;(t=t.toJson()).errors.length||(n=JSON.parse(d.readFileSync(Object(p.d)("dist/ssr-server-bundle.json"))),r&&i({bundle:n,clientManifest:r,fs:s}))}),{readyPromise:o,webpackMiddleware:f}}},function(e,t){e.exports=require("pug")},function(e,t,r){"use strict";r.r(t);var n=r(22),s=r.n(n),o=r(4),a=r.n(o),i=r(21),c=r.n(i),u=r(20),l=r.n(u),p=r(19),f=r.n(p),d=r(18),b=r.n(d),m=r(17),g=r.n(m),h=r(16),v=r.n(h),w=r(15),j=r.n(w),x=r(7),y=r.n(x),O=r(14),k=r.n(O),P=r(13),q=r(0);function S(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var _,E,M=a()("1stg:server"),R=q.b?r(24).renderFile(Object(q.d)("server/template.pug"),{pretty:!0}):s.a.readFileSync(Object(q.d)("dist/template.html"),"utf-8"),F=new c.a,C=k()(1e3),A=[v()(),j()("/public",y()(Object(q.d)("public"),{maxAge:31536e6})),async function(e,t){if(q.b)await _;else if(await e.cashed())return;if("GET"!==e.method||e.url.lastIndexOf(".")>e.url.lastIndexOf("/")||!["*/*","text/html"].find(function(t){return e.get("Accept").includes(t)}))return t();var r={ctx:e,title:"React Hackernews"};e.respond=!1;var n=e.res;E.renderToStream(r).on("afterRender",function(){e.status=r.code||200,e.set({"Content-Type":"text/html"})}).on("error",function(t){var r=t.status,s=t.url;if(s)return e.status=302,e.set({Location:s}),n.end();switch(e.status=r||500,r){case 404:return n.end("404 | Page Not Found");default:n.end("500 | Internal Server Error"),M("error during render : ".concat(s)),M(t.stack)}}).pipe(n)}],D=function(e,t){return Object(P.createBundleRenderer)(e,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){S(e,t,r[t])})}return e}({},t,{template:R,basedir:Object(q.d)("dist/static"),runInNewContext:!1}))};if(q.b){var I=r(23).default(function(e){var t=e.bundle,r=e.clientManifest;E=D(t,{clientManifest:r})}),T=I.readyPromise,$=I.webpackMiddleware;_=T,A.push($)}else{E=D(Object(q.e)(Object(q.d)("dist/ssr-server-bundle.json")),{clientManifest:Object(q.e)(Object(q.d)("dist/ssr-client-manifest.json"))});var N={};A.splice(1,0,b()(),y()(Object(q.d)("dist/static"),{maxAge:31536e6},N),g()(l()({get:function(e){return C.get(e)},set:function(e,t){return C.set(e,t)}}))),N["/service-worker.js"].maxAge=0}F.use(f()(A)),F.listen(q.g,q.f,function(){M("Server start listening at %s:%s",q.f,q.g)})}]);